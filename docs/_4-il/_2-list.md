# 列表


## 创建

```
a = '(1 2 3)
b = `(1 2 3)
c = [1 2 3]
d = (list 1 2 3)
print a b c d
```

输出都是(1 2 3)

a 什么都不做，创建一个看起来就是这样的列表，相当于普通字符串

c 是 d 的语法糖形式，与 a 不同之处在于它会对每一个元素进行求值再变成列表

b 相当于格式化字符串的列表形式，会对`:`，`_`，`\`作出特殊反应，不论嵌套深度

### 格式化列表

`\`是转义符，读取到时，去掉一层`\`，将其中的内容放回原处

`:`是立即读取，读取到时，立即求值并放回原处(用于函数递归时，由于函数返回的函数对象后续会完善所以没什么关系)

`_`包括`_`，`_<i>`，`__`，`__args__`，作用是读取当前的函数参数列表

整个程序被视作一个特殊的函数，所以在最外部使用意味着读取整个程序的输入参数(如果有)

`__args__`返回参数列表本身

`_<i>`是`(__args__ <i>)`的语法糖形式，表示按索引取值参数

`_`以迭代的形式取参数，第 1 次调用取第 1 个，第 2 次调用取第 2 个，以此类推，不会影响到`__args__`和`_<i>`的取值

`__`会一次性迭代完后续所有的参数，并且解包，也就是说，如果参数列表是`[1,2,3,4]`，并且此前已经使用了 1 次`_`，使用`(print __)`等价于`(print 2 3 4)`

## 取值

```
a = [0 1 2 3]
print (a 0)   # 0
print (a 1 2)   # (1)
print (a nil 2)  # (0 1)
print (head a)  # 0
print (tail a)  # (1 2 3)
print (head a 1)  # (0)
print (tail a 1)  # (1 2 3)
```
如果只有 1 个参数，且为整数，为取索引

如果有 2 个参数，且为整数或`nil`，和 python 切片行为一致

`head`和`tail`会分别取头元素和剩余的元素

当在后面增加数字作为额外的参数时，会将数字作为索引返回头或者尾，保持左闭右开

切片和`head`和`tail`接受负数作为索引

![](https://s2.loli.net/2022/10/27/Wo18NlrzVqEJMZT.png)

## 增加值

```
a = [0]
++ a 1
a += [2]
a 'append 3
push a 4
print a   # (4 0 1 2 3)
```

注意这里都是直接推到列表尾部的，除了`push`

## 插入值

```
a = [1 2 3]
(a 2 2) = 'a 'b
(a 'insert 1 'c 'd)
print a   # (1 'c 'd 2 'a 'b 3)
```

## 删除值

```
a = [0 1 2 3 4 5]
(a 5 6) = []
print a      # (0 1 2 3 4)
(a 'del 4)
print a      # (0 1 2 3)
(del (a 3))
print a      # (0 1 2)
(a 'pop)
print a      # (0 1)
pop a
print a      # (1)
```

注意，当`pop`作为操作符时弹出第0项而不是最后一项，与`push`对应

而它作为列表的一个方法时，弹出的是最后一项，与`append`对应

## 修改值

```
a = [1 2 3]
(a 0) = "hello"
(a 1 3) = "world"
print a   # ("hello" "world")
```

## 其它方法

### 求长度

```
len a
a 'len
```

### 反转

```
reversed a
a 'reverse
a = (a nil nil -1)
```

都会返回反转后的列表，但是只有`(a 'reverse)`会对列表本身产生影响